{"name":"rails-angular-bower-heroku","tagline":"Sample application for using bower to manage JavaScript packages for Rails on Heroku","body":"# rails-angular-bower-heroku #\r\n\r\nSample application for using Bower to manage JavaScript packages for Rails on Heroku.\r\n\r\n## Objective ##\r\n\r\nMy objective for this project was to create a boilerplate template for projects with [Rails 4.0] (http://rubyonrails.org), [AngularJS] (https://angularjs.org) and [Bootstrap] (https://getbootstrap.com) to be deployed on [Heroku] (https://www.heroku.com) with optimized package management for client JavaScript and stylesheets via [Bower] (https://www.bower.io).\r\n\r\nIn addtion I added some tests for Rails and AngularJS and a continous delivery environment on [Codeship.io] (https://codeship.io).\r\n\r\nFeedback welcome!\r\n\r\n## Basic Steps ##\r\n\r\n#### Installation Bower ####\r\n\r\n```bash\r\nnpm install bower\r\n```\r\n\r\n#### Setup Bower ####\r\n\r\n```js\r\n// .bowerrc\r\n{\r\n  \"directory\": \"vendor/assets/components\"\r\n}\r\n```\r\n\r\n#### Install Packages ####\r\n\r\n```bash\r\nbower install angular\r\nbower install angular-resource\r\nbower install bootstrap\r\n```\t\r\n\r\n#### Create bower.json ####\r\n\r\n```bash\r\nbower init\r\n```\r\n\r\nThe script will ask you some questions and using the existing packages to create the bower.json file. Alternatively the bower.json can be written manually and the packages installed by \r\n\r\n```bash\r\nbower install\r\n```\r\n\r\n#### Configure Rails ####\r\n\r\n```ruby\r\n// ./config/application.rb\r\n\r\nconfig.assets.precompile.shift\r\n\r\n# Add additional asset pathes\r\nconfig.assets.paths << Rails.root.join('vendor', 'assets', 'components')\r\nconfig.assets.paths << Rails.root.join('vendor', 'assets', 'components', 'bootstrap', 'dist', 'fonts')\r\nconfig.assets.paths << Rails.root.join('vendor', 'assets', 'fonts')\r\n\r\n# Precompile additional asset types\r\nconfig.assets.precompile.push(Proc.new do |path|\r\n  File.extname(path).in? [\r\n    '.html', '.erb', '.haml',                 # Templates\r\n    '.png',  '.gif', '.jpg', '.jpeg', '.svg', # Images\r\n    '.eot',  '.otf', '.svc', '.woff', '.ttf', # Fonts\r\n  ]\r\nend)\r\n```\r\n\r\nFor the production environment enable asset compilation\r\n\r\n```ruby\r\n# config/environments/production.rb\r\nconfig.assets.compile = true\r\n```\r\n\r\n#### Configure Heroku ####\r\n\r\n```bash\r\nheroku config:set BUILDPACK_URL='git://github.com/qnyp/heroku-buildpack-ruby-bower.git#run-bower'\r\n```\r\n\r\n#### Install on Heroku ####\r\n\r\n```bash\r\ngit push git@heroku.com:rails-angular-bower-heroku.git master\r\n```\r\n\r\nHeroku will now install all JavaScript packages via Bower and compile the assets so that JavaScript and stylesheets are minified.\r\n\r\n#### Compressing Ressources ####\r\n\r\nCompression of JavaScript and Stylesheets is quickly added by adding the gem 'heroku_rails_deflate' to the Gemfile and installing it.\r\n\r\n```ruby\r\n// .Gemfil\r\ngroup :production, :staging do\r\n  gem 'heroku_rails_deflate'\r\n  gem 'rails_12factor'\r\nend\r\n```\t\r\n\r\n## Issues with Bootstrap ##\r\n\r\nThe Bower package for [Bootstrap] (http://getbootstrap.com) contains not only the dist folder but the complete website for whatever reason. Additionally it contains fonts used for the glyphicons. The assets compilation creates a wrong path for the fonts which can be rewritten. Special thanks for the hint to [Matt Garrison](https://github.com/mattsgarrison).\r\n\r\n```ruby\r\n// ./config/initializers/rack_rewrite.rb\r\nRailsAngularBowerHeroku::Application.config.middleware.insert_before(Rack::Runtime, Rack::Rewrite) do\r\n  rewrite %r{/fonts/(.*)}, '/assets/bootstrap/fonts/$1'\r\n  rewrite %r{/font/(.*)}, '/assets/bootstrap/font/$1'\r\nend\r\n```\r\n\r\n## Continous Integration and Deployment ##\r\n\r\nFinally I configured an application on [Codeship.io] (http://www.codeship.io) to build the application, execute all tests and if tests succeed to deploy it automatically on [http://rails-angular-bower-heroku.herokuapp.com] ([http://rails-angular-bower-heroku.herokuapp.com).\r\n\r\n#### Node package installation ####\r\n\r\nTo automate the installation of Bower and all other components a package.json is required:\r\n\r\n```js\r\n// .package.json\r\n{\r\n  \"name\": \"rails-angular-bower-heroku\",\r\n  \"version\": \"0.0.0\",\r\n  \"devDependencies\": {\r\n    \"bower\": \"~1.2.6\",\r\n    \"karma\": \"~0.10.4\",\r\n    \"karma-jasmine\": \"~0.1.3\",\r\n    \"karma-chrome-launcher\": \"~0.1.0\",\r\n    \"karma-phantomjs-launcher\":\"~0.1.0\"\r\n  }\r\n}\r\n```\r\n\r\nInstall everything now with \r\n\r\n```bash\r\nnpm install\r\nbower install\r\n```\r\n\r\n#### Karma configuration ####\r\n\r\nWith karma init a file can be generated. The important section if files in which all JavaScript in the correct order has to loaded. The JavaScript libraries of Angular are loaded from vendor/assets/components, the application files from app/assets and the tests from spec.\r\n\r\n```js\r\n//. karma.conf.js\r\n// Karma configuration\r\n// Generated on Sun Oct 27 2013 20:48:21 GMT+0100 (CET)\r\n\r\nmodule.exports = function(config) {\r\n  config.set({\r\n\r\n    // base path, that will be used to resolve files and exclude\r\n    basePath: '',\r\n\r\n    // frameworks to use\r\n    frameworks: ['jasmine'],\r\n\r\n    // list of files / patterns to load in the browser\r\n    files: [\r\n      'vendor/assets/components/angular/angular.js',\r\n      'vendor/assets/components/angular-resource/angular-resource.js', \r\n      'app/assets/javascripts/application.js', \r\n      'app/assets/javascripts/app.js', \r\n      'app/assets/javascripts/**/*.js',\r\n      'spec/angular/*_spec.js'   \r\n    ],\r\n\r\n    // list of files to exclude\r\n    exclude: [\r\n      \r\n    ],\r\n\r\n    // test results reporter to use\r\n    // possible values: 'dots', 'progress', 'junit', 'growl', 'coverage'\r\n    reporters: ['progress'],\r\n\r\n    // web server port\r\n    port: 9876,\r\n\r\n    // enable / disable colors in the output (reporters and logs)\r\n    colors: true,\r\n\r\n    // level of logging\r\n    // possible values: config.LOG_DISABLE || config.LOG_ERROR || config.LOG_WARN || config.LOG_INFO || config.LOG_DEBUG\r\n    logLevel: config.LOG_INFO,\r\n\r\n    // enable / disable watching file and executing tests whenever any file changes\r\n    autoWatch: true,\r\n\r\n    // Start these browsers, currently available:\r\n    // - Chrome\r\n    // - ChromeCanary\r\n    // - Firefox\r\n    // - Opera (has to be installed with `npm install karma-opera-launcher`)\r\n    // - Safari (only Mac; has to be installed with `npm install karma-safari-launcher`)\r\n    // - PhantomJS\r\n    // - IE (only Windows; has to be installed with `npm install karma-ie-launcher`)\r\n    // browsers: ['Chrome', 'PhantomJS'],\r\n    browsers: ['PhantomJS'],\r\n\r\n    // If browser does not capture in given timeout [ms], kill it\r\n    captureTimeout: 60000,\r\n\r\n    // Continuous Integration mode\r\n    // if true, it capture browsers, run tests and exit\r\n    singleRun: false\r\n  });\r\n};\r\n```\r\n\r\n### Codeship.io ###\r\n\r\nTo build and test the application the settings for the following sections have to be adapted:\r\n\r\n#### Setup commands ####\r\n\r\n```bash\r\nrvm use 2.0.0\r\nbundle install\r\nexport RAILS_ENV=test\r\nbundle exec rake db:schema:load\r\nnpm install \r\nbower install\r\n```\r\n\r\n#### Test commands ####\r\n\r\nThe test commands for Codeship:\r\n\r\n```bash\r\nbundle exec rspec\r\nkarma start --single-run\r\n```\r\n\r\n## Build Status ##\r\n\r\n[ ![Codeship Status for stiebitzhofer/rails-angular-bower-heroku](https://www.codeship.io/projects/a4bfc1d0-1d1e-0131-6161-2e26d21abb16/status?branch=master)](https://www.codeship.io/projects/8390)\r\n\r\n\r\n## Resources and References ##\r\n\r\n[Heroku Buildpack for Ruby and Bower] (https://github.com/qnyp/heroku-buildpack-ruby-bower)\r\n\r\n[Gist by Aidan Feldman describing the basic steps] (https://gist.github.com/afeld/5704079)\r\n\r\n[Matt Garrison on Bower and Rails 4] (http://www.iconoclastlabs.com/blog/bower-and-rails-4)\r\n\r\n[http://rails-angular-bower-heroku.herokuapp.com] (http://rails-angular-bower-heroku.herokuapp.com)\r\n\r\n[Bootstrapping an AngularJS app in Rails 4.0] (http://asanderson.org/posts/2013/06/03/bootstrapping-angular-rails-part-1.html) is an excellent tutorial explaining in detail what I have done in this project.\r\n\r\n## TODOs ##\r\nWrite some more useful tests.\r\n\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}